{"version":3,"sources":["drizzle.min.js","drizzle.js"],"names":["root","factory","define","amd","exports","module","Drizzle","this","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","TypeError","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","_get","get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","undefined","parent","getPrototypeOf","getter","_slicedToArray","sliceIterator","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","push","err","_createClass","defineProperties","target","props","descriptor","defineProperty","key","protoProps","staticProps","_typeof","obj","D","slice","EMPTY","map","fn","result","mapObj","hasOwnProperty","clone","isObject","_ret","v","typeCache","View","Region","Module","Model","register","type","name","clazz","Clazz","_len","arguments","args","_key","bind","apply","concat","counter","item","toString","_len2","_key2","assign","uniqueId","prefix","adapt","Adapter","__events","__createHandler","region","selector","e","matched","getElement","querySelectorAll","el","contains","trigger","__captures","Promise","ajax","params","Error","ajaxResult","getEventTarget","currentTarget","getFormData","delegateDomEvent","renderable","event","id","listenTo","handler","addEventListener","indexOf","undelegateDomEvents","stopListening","removeEventListener","hasClass","classList","addClass","add","removeClass","remove","Promiser","context","_this","resolve","reject","data","items","_this2","_len3","_key3","thenables","indexMap","isFunction","then","all","as","_this3","_len4","_key4","prev","doRing","rings","ring","nextRing","shift","parallel","Event","on","ctx","_events","off","_len5","_key5","delegateEvent","to","me","_listeners","_len6","_key6","unshift","Request","model","options","_ajax","post","put","del","save","_idKey","_url","parts","_option","urlRoot","app","urlSuffix","base","pop","join","method","url","_len7","_key7","set","slient","_len8","_key8","ComponentManager","_handlers","_componentCache","setDefaultHandler","creator","destructor","_defaultHandler","handlers","_create","_this4","opt","error","dom","$$","$","uid","chain","component","cid","cache","index","_destroy","_this5","current","Base","defaults","mixin","_mixin","_loadedPromise","_initialize","_len9","_key9","message","isString","_len10","rest","_key10","_this6","_arguments","old","_Promise","Renderable","_D$Base","mod","loader","_this7","components","_loader","_componentMap","_eventHandlers","_templateEngine","_this8","_load","_initializeEvents","_ref","_ref2","template","_template","_render","_wrapDomId","_element","_this9","renderOptions","_destroyComponents","_beforeRender","_serializeData","_renderTemplate","_renderComponents","_afterRender","_region","_bindEvents","_this10","_beforeClose","_unbindEvents","destroyComponents","_empty","_afterClose","Global","global","Self","_execute","events","_this11","replace","split","_error","eventType","haveStar","_createEventHandler","handlerName","_ref3","_this12","disabledClass","getAttribute","_this13","_delegateDomEvent","_undelegateDomEvents","_this14","_this15","destroy","RenderableContainer","_D$Renderable","promise","_items","_initializeItems","_initializeRegions","_renderItems","_closeRegions","_this17","isModule","moduleOptions","_this18","_regions","closeRegions","_createRegion","_this19","regions","show","close","ActionCreator","_D$Renderable2","_actions","_createAction","_this21","_ref4","dataForAction","_ref5","actionCallback","_getActionPayload","payload","dispatch","rootEl","targetName","tagName","parentNode","_D$ActionCreator","bindings","_initializeDataBinding","_this23","_dataBinding","store","render","_this24","_get2","_len11","_key11","_bindData","_get3","_len12","_key12","_unbindData","_this25","_D$RenderableContaine","_modules","_store","_createStore","_destory","_this27","_loadEagerModels","_this28","_loadLazyModels","_D$Base2","_this29","_el","_this30","_isCurrent","forceRender","_current","_createModule","_ref6","_ref7","_getElement","setAttribute","_setRegion","_this31","innerHTML","TemplateEngine","_D$Base3","_templateCache","Store","_D$Base4","_this33","_models","_callbacks","callback","n","p","_callbackContext","_initializeModels","models","_this34","shared","viewport","_createModel","autoLoad","_D$Base5","_this35","_data","idKey","_params","d","changed","cloneIt","Loader","_D$Base6","path","_this37","_app$options","scriptRoot","getResource","fullPath","require","loadResource","fileNames","loadModuleResource","view","router","Application","_D$Base7","caseSensitiveHash","defaultRegion","document","body","attributesReferToId","pagination","pageSize","pageKey","pageSizeKey","recordCountKey","_loaders","registerLoader","isDefault","loaders","_defaultLoader","defaultRouter","_this39","_this40","_D$Loader$_analyse","_analyse","moduleName","loaderName","_getLoader","loadModule","createModule","_this41","_D$Loader$_analyse2","viewName","loadView","createView","_D$Loader$_analyse3","regionName","createRegion","createStore","createModel","ROUTER_REGEXPS","history","Route","pattern","RegExp","hash","lastIndex","test","_router","_this42","exec","_getInterceptors","Router","_D$Base8","_routes","_routeMap","_interceptors","location"],"mappings":"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","file":"drizzle.min.js","sourcesContent":[";(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.Drizzle = factory();\n  }\n}(this, function() {\n'use strict';\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*!\n * DrizzleJS v0.3.18\n * -------------------------------------\n * Copyright (c) 2016 Jaco Koo <jaco.koo@guyong.in>\n * Distributed under MIT license\n */\n\nvar Drizzle = {},\n    D = Drizzle,\n    slice = [].slice,\n    EMPTY = function EMPTY() {},\n    map = function map(arr, fn) {\n    var result = [];\n    if (!arr) return result;\n    if (arr.map) return arr.map(fn);\n\n    for (var i = 0; i < arr.length; i++) {\n        result.push(fn(arr[i], i, arr));\n    }\n    return result;\n},\n    mapObj = function mapObj(obj, fn) {\n    var result = [];\n    var key = undefined;\n    if (!obj) return result;\n\n    for (key in obj) {\n        if (D.hasOwnProperty.call(obj, key)) result.push(fn(obj[key], key, obj));\n    }\n\n    return result;\n},\n    clone = function clone(target) {\n    if (D.isObject(target)) {\n        var _ret = function () {\n            var result = {};\n            mapObj(target, function (value, key) {\n                result[key] = clone(value);\n            });\n            return {\n                v: result\n            };\n        }();\n\n        if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === \"object\") return _ret.v;\n    }\n\n    if (D.isArray(target)) {\n        return map(target, function (value) {\n            return clone(value);\n        });\n    }\n\n    return target;\n},\n    typeCache = {\n    View: {}, Region: {}, Module: {}, Model: {},\n\n    register: function register(type, name, clazz) {\n        this[type][name] = clazz;\n    },\n    create: function create(type, name) {\n        var Clazz = this[type][name] || D[type];\n\n        for (var _len = arguments.length, args = Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n            args[_key - 2] = arguments[_key];\n        }\n\n        return new (Function.prototype.bind.apply(Clazz, [null].concat(args)))();\n    }\n};\n\nvar counter = 0;\n\nmap(['Function', 'Array', 'String', 'Object'], function (item) {\n    D['is' + item] = function (obj) {\n        return D.toString.call(obj) === '[object ' + item + ']';\n    };\n});\n\nmap(['Module', 'View', 'Region', 'Model', 'Store'], function (item) {\n    D['register' + item] = function (name, clazz) {\n        return typeCache.register(item, name, clazz);\n    };\n    typeCache['create' + item] = function (name) {\n        for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n            args[_key2 - 1] = arguments[_key2];\n        }\n\n        return typeCache.create.apply(typeCache, [item, name].concat(args));\n    };\n});\n\nObject.assign(D, {\n    uniqueId: function uniqueId() {\n        var prefix = arguments.length <= 0 || arguments[0] === undefined ? '' : arguments[0];\n\n        return '' + prefix + ++counter;\n    },\n    adapt: function adapt(obj) {\n        Object.assign(D.Adapter, obj);\n    }\n});\n\nvar __events = {};\nvar __createHandler = function __createHandler(region, name, selector) {\n    return function (e) {\n        var target = e.target;\n        var matched = false;\n        map(region.getElement().querySelectorAll(selector), function (el) {\n            if (el === target || el.contains(target)) {\n                matched = el;\n            }\n        });\n\n        matched && region.trigger(name, e);\n    };\n};\nvar __captures = ['blur', 'focus', 'scroll', 'resize'];\n\nD.Adapter = {\n    Promise: Promise,\n\n    ajax: function ajax(params) {\n        throw new Error('Ajax is not implemented');\n    },\n    ajaxResult: function ajaxResult(args) {\n        return args[0];\n    },\n    getEventTarget: function getEventTarget(e) {\n        return e.currentTarget || e.target;\n    },\n    getFormData: function getFormData(el) {},\n    delegateDomEvent: function delegateDomEvent(region, renderable, name, selector, fn) {\n        var event = name + '-' + region.id,\n            id = region.id + '-' + renderable.id;\n        renderable.listenTo(region, event, fn);\n        __events[id] || (__events[id] = {});\n        var handler = __events[id][name] = __createHandler(region, event, selector);\n        region.getElement().addEventListener(name, handler, __captures.indexOf(name) !== -1);\n    },\n    undelegateDomEvents: function undelegateDomEvents(region, renderable) {\n        var id = region.id + '-' + renderable.id;\n        renderable.stopListening(region);\n        mapObj(__events[id], function (handler, name) {\n            region.getElement.removeEventListener(name, handler);\n        });\n        delete __events[id];\n    },\n    hasClass: function hasClass(el, clazz) {\n        return el.classList.contains(clazz);\n    },\n    addClass: function addClass(el, clazz) {\n        el.classList.add(clazz);\n    },\n    removeClass: function removeClass(el, clazz) {\n        el.classList.remove(clazz);\n    }\n};\n\nD.Promise = function () {\n    function Promiser(context) {\n        _classCallCheck(this, Promiser);\n\n        this.context = context;\n    }\n\n    _createClass(Promiser, [{\n        key: 'create',\n        value: function create(fn) {\n            var _this = this;\n\n            return new D.Adapter.Promise(function (resolve, reject) {\n                fn.call(_this.context, resolve, reject);\n            });\n        }\n    }, {\n        key: 'resolve',\n        value: function resolve(data) {\n            return D.Adapter.Promise.resolve(data);\n        }\n    }, {\n        key: 'reject',\n        value: function reject(data) {\n            return D.Adapter.Promise.reject(data);\n        }\n    }, {\n        key: 'parallel',\n        value: function parallel(items) {\n            var _this2 = this;\n\n            for (var _len3 = arguments.length, args = Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n                args[_key3 - 1] = arguments[_key3];\n            }\n\n            return this.create(function (resolve, reject) {\n                var result = [],\n                    thenables = [],\n                    indexMap = {};\n                map(items, function (item, i) {\n                    var value = D.isFunction(item) ? item.apply(_this2.context, args) : item;\n                    if (value && value.then) {\n                        indexMap[thenables.length] = i;\n                        thenables.push(value);\n                    } else {\n                        result[i] = value;\n                    }\n                });\n\n                if (thenables.length === 0) return resolve(result);\n\n                D.Adapter.Promise.all(thenables).then(function (as) {\n                    mapObj(indexMap, function (key, value) {\n                        return result[value] = as[key];\n                    });\n                    resolve(result);\n                }, function (as) {\n                    reject(as);\n                });\n            });\n        }\n    }, {\n        key: 'chain',\n        value: function chain() {\n            var _this3 = this;\n\n            for (var _len4 = arguments.length, args = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n                args[_key4] = arguments[_key4];\n            }\n\n            var prev = null;\n            var doRing = function doRing(rings, ring, resolve, reject) {\n                var nextRing = function nextRing(data) {\n                    prev = data;\n                    rings.length === 0 ? resolve(prev) : doRing(rings, rings.shift(), resolve, reject);\n                };\n\n                if (D.isArray(ring)) {\n                    ring.length === 0 ? nextRing([]) : _this3.parallel.apply(_this3, [ring].concat(_toConsumableArray(prev != null ? [prev] : []))).then(nextRing, reject);\n                } else {\n                    var value = D.isFunction(ring) ? ring.apply(_this3.context, prev != null ? [prev] : []) : ring;\n                    value && value.then ? value.then(nextRing, reject) : nextRing(value);\n                }\n            };\n\n            if (args.length === 0) return this.resolve();\n\n            return this.create(function (resolve, reject) {\n                doRing(args, resolve, reject, args.shift(), 0);\n            });\n        }\n    }]);\n\n    return Promiser;\n}();\n\nD.Event = {\n    on: function on(name, fn, ctx) {\n        this._events || (this._events = {});\n        (this._events[name] || (this._events[name] = [])).push({ fn: fn, ctx: ctx });\n    },\n    off: function off(name, fn) {\n        if (!this._events || !name || !this._events[name]) return;\n        if (!fn) return delete this._events[name];\n\n        var result = [];\n        map(this._events[name], function (item) {\n            if (item.fn !== fn) result.push(item);\n        });\n\n        if (result.length === 0) return delete this._events[name];\n        this._events[name] = result;\n    },\n    trigger: function trigger(name) {\n        for (var _len5 = arguments.length, args = Array(_len5 > 1 ? _len5 - 1 : 0), _key5 = 1; _key5 < _len5; _key5++) {\n            args[_key5 - 1] = arguments[_key5];\n        }\n\n        if (!name || !this._events || !this._events[name]) return this;\n        map(this._events[name], function (item) {\n            return item.fn.apply(item.ctx, args);\n        });\n    },\n    delegateEvent: function delegateEvent(to) {\n        var me = this,\n            id = '--' + to.id,\n            target = to;\n\n        Object.assign(target, {\n            _listeners: {},\n\n            listenTo: function listenTo(obj, name, fn) {\n                (target._listeners[name] || (target._listeners[name] = [])).push({ fn: fn, obj: obj });\n                obj.on(name, fn, target);\n            },\n            stopListening: function stopListening(obj, name, fn) {\n                if (!obj) {\n                    mapObj(target._listeners, function (value, key) {\n                        return map(value, function (item) {\n                            return item.obj.off(key, item.fn);\n                        });\n                    });\n                    target._listeners = {};\n                    return;\n                }\n\n                if (!name) {\n                    mapObj(target._listeners, function (value, key) {\n                        return map(value, function (item) {\n                            return me.off(key, item);\n                        });\n                    });\n                    target._listeners = {};\n                    return;\n                }\n\n                var result = [];\n                map(target._listeners[name], function (item) {\n                    return fn && fn !== item ? result.push(item) : me.off(name, item);\n                });\n                target._listeners[name] = result;\n\n                if (result.length === 0) delete target._listeners[name];\n            },\n            on: function on(name, fn, context) {\n                target.listenTo(me, name + id, context);\n            },\n            off: function off(name, fn) {\n                target.stopListening(me, name && name + id, fn);\n            },\n            trigger: function trigger(name) {\n                if (!name) return target;\n\n                for (var _len6 = arguments.length, args = Array(_len6 > 1 ? _len6 - 1 : 0), _key6 = 1; _key6 < _len6; _key6++) {\n                    args[_key6 - 1] = arguments[_key6];\n                }\n\n                args.unshift(name + id) && me.trigger.apply(me, args);\n            }\n        });\n        return this;\n    }\n};\n\nD.Request = {\n    get: function get(model, options) {\n        return this._ajax('GET', model, model.params, options);\n    },\n    post: function post(model, options) {\n        return this._ajax('POST', model, model.data, options);\n    },\n    put: function put(model, options) {\n        return this._ajax('PUT', model, model.data, options);\n    },\n    del: function del(model, options) {\n        return this._ajax('DELETE', model, model.data, options);\n    },\n    save: function save(model, options) {\n        return model.data && model.data[model._idKey] ? this.put(model, options) : this.post(model, options);\n    },\n    _url: function _url(model) {\n        var parts = [],\n            prefix = model.module._option('urlPrefix', model) || '',\n            urlRoot = model.app._option('urlRoot', model) || '',\n            urlSuffix = model.app._option('urlSuffix', model) || '';\n        var base = model._url() || '';\n\n        urlRoot && parts.push(urlRoot);\n        prefix && parts.push(prefix);\n        parts.push(model.module.name);\n\n        while (base.indexOf('../') === 0) {\n            parts.pop();\n            base = base.slice(3);\n        }\n\n        base && parts.push(base);\n        model.data && model.data[model._idKey] && parts.push(model.data[model._idKey]);\n        urlSuffix && parts.push(urlSuffix);\n\n        return parts.join('/');\n    },\n    _ajax: function _ajax(method, model, data, options) {\n        var params = Object.assign({ type: method }, options);\n\n        params.data = Object.assign({}, data, params.data);\n        params.url = this._url(model);\n\n        return D.Promise.create(function (resolve, reject) {\n            D.Adapter.ajax(params).then(function () {\n                for (var _len7 = arguments.length, args = Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {\n                    args[_key7] = arguments[_key7];\n                }\n\n                model.set(D.Adapter.ajaxResult(args), !params.slient);\n                resolve(args);\n            }, function () {\n                for (var _len8 = arguments.length, args = Array(_len8), _key8 = 0; _key8 < _len8; _key8++) {\n                    args[_key8] = arguments[_key8];\n                }\n\n                return reject(args);\n            });\n        });\n    }\n};\n\nD.ComponentManager = {\n    _handlers: {},\n    _componentCache: {},\n\n    setDefaultHandler: function setDefaultHandler(creator) {\n        var destructor = arguments.length <= 1 || arguments[1] === undefined ? EMPTY : arguments[1];\n\n        this._defaultHandler = { creator: creator, destructor: destructor };\n    },\n    register: function register(name, creator, destructor) {\n        this.handlers[name] = { creator: creator, destructor: destructor || EMPTY };\n    },\n    _create: function _create(renderable, options) {\n        var _this4 = this;\n\n        var name = options.name;\n        var id = options.id;\n        var selector = options.selector;\n        var opt = options.options;\n\n        if (!name) renderable.error('Component name can not be null');\n\n        var handler = this._handlers[name] || this._defaultHandler;\n        if (!handler) renderable.error('No handler for component:', name);\n\n        var dom = selector ? renderable.$$(selector) : renderable.$(id);\n        var uid = id ? id : D.uniqueId('comp');\n\n        return renderable.chain(handler.creator(renderable, dom, opt), function (component) {\n            var cid = renderable.id + uid,\n                cache = _this4._componentCache[cid],\n                obj = { id: cid, handler: handler, index: D.uniqueId(cid), options: opt };\n\n            D.isArray(cache) ? cache.push(obj) : _this4._componentCache[cid] = cache ? [cache, obj] : obj;\n            return { id: id, component: component, index: obj.index };\n        });\n    },\n    _destroy: function _destroy(renderable, obj) {\n        var _this5 = this;\n\n        var id = renderable.id + obj.id,\n            cache = this._componentCache[id];\n        var current = cache;\n\n        if (D.isArray(cache)) {\n            this._componentCache[id] = [];\n            map(cache, function (item) {\n                item.index !== obj.index ? _this5._componentCache[id].push(item) : current = item;\n            });\n            this._componentCache[id].length === 0 && delete this._componentCache[id];\n        } else {\n            delete this._componentCache[id];\n        }\n\n        current.handler.destructor(renderable, obj.component, current.options);\n    }\n};\n\nD.Base = function () {\n    function Base(name) {\n        var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n        var defaults = arguments[2];\n\n        _classCallCheck(this, Base);\n\n        this.options = options;\n        this.id = D.uniqueId('D');\n        this.name = name;\n        this.Promise = new D.Promise(this);\n\n        Object.assign(this, defaults);\n        if (options.mixin) this._mixin(options.mixin);\n        this._loadedPromise = this._initialize();\n    }\n\n    _createClass(Base, [{\n        key: '_initialize',\n        value: function _initialize() {}\n    }, {\n        key: '_option',\n        value: function _option(key) {\n            var value = this.options[key];\n\n            for (var _len9 = arguments.length, args = Array(_len9 > 1 ? _len9 - 1 : 0), _key9 = 1; _key9 < _len9; _key9++) {\n                args[_key9 - 1] = arguments[_key9];\n            }\n\n            return D.isFunction(value) ? value.apply(this, args) : value;\n        }\n    }, {\n        key: '_error',\n        value: function _error(message) {\n            if (!D.isString(message)) throw message;\n\n            for (var _len10 = arguments.length, rest = Array(_len10 > 1 ? _len10 - 1 : 0), _key10 = 1; _key10 < _len10; _key10++) {\n                rest[_key10 - 1] = arguments[_key10];\n            }\n\n            throw new Error('[' + (this.module ? this.module.name + ':' : '') + this.name + '] ' + message + ' ' + rest.join(' '));\n        }\n    }, {\n        key: '_mixin',\n        value: function _mixin(obj) {\n            var _this6 = this,\n                _arguments = arguments;\n\n            mapObj(obj, function (value, key) {\n                var old = _this6[key];\n                if (!old) {\n                    _this6[key] = value;\n                    return;\n                }\n\n                if (D.isFunction(old)) {\n                    _this6[key] = function () {\n                        var args = slice.call(_arguments);\n                        args.unshift(old);\n                        return value.apply(_this6, args);\n                    };\n                }\n            });\n        }\n    }, {\n        key: 'chain',\n        value: function chain() {\n            var _Promise;\n\n            return (_Promise = this.Promise).chain.apply(_Promise, arguments);\n        }\n    }]);\n\n    return Base;\n}();\n\nD.Renderable = function (_D$Base) {\n    _inherits(Renderable, _D$Base);\n\n    function Renderable(name, app, mod, loader, options) {\n        _classCallCheck(this, Renderable);\n\n        var _this7 = _possibleConstructorReturn(this, Object.getPrototypeOf(Renderable).call(this, name, options, {\n            app: app,\n            module: mod,\n            components: {},\n            _loader: loader,\n            _componentMap: {},\n            _events: {}\n        }));\n\n        _this7._eventHandlers = _this7._option('handlers');\n        _this7._templateEngine = _this7._option('templateEngine') || mod && mod._templateEngine || app._templateEngine;\n        app.delegateEvent(_this7);\n        return _this7;\n    }\n\n    _createClass(Renderable, [{\n        key: '_initialize',\n        value: function _initialize() {\n            var _this8 = this;\n\n            return this.chain([this._templateEngine._load(this), this._initializeEvents()], function (_ref) {\n                var _ref2 = _slicedToArray(_ref, 1);\n\n                var template = _ref2[0];\n                return _this8._template = template;\n            });\n        }\n    }, {\n        key: 'render',\n        value: function render(options) {\n            return this._render(options, true);\n        }\n    }, {\n        key: '$',\n        value: function $(id) {\n            return this.$$('#' + this._wrapDomId(id))[0];\n        }\n    }, {\n        key: '$$',\n        value: function $$(selector) {\n            return this._element.querySelectorAll(selector);\n        }\n    }, {\n        key: '_render',\n        value: function _render() {\n            var _this9 = this;\n\n            var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n            var update = arguments[1];\n\n            if (!this.region) this.error('Region is null');\n\n            this.renderOptions = options;\n            return this.chain(this._loadedPromise, this._destroyComponents, function () {\n                return _this9.trigger('beforeRender');\n            }, function () {\n                return _this9._option('beforeRender');\n            }, this._beforeRender, this._serializeData, this._renderTemplate, this._renderComponents, this._afterRender, function () {\n                return _this9._option('afterRender');\n            }, function () {\n                return _this9.trigger('afterRender');\n            }, this);\n        }\n    }, {\n        key: '_setRegion',\n        value: function _setRegion(region) {\n            this._region = region;\n            this._bindEvents();\n        }\n    }, {\n        key: '_close',\n        value: function _close() {\n            var _this10 = this;\n\n            if (!this._region) return this.Promise.resolve(this);\n\n            return this.chain(function () {\n                return _this10.trigger('beforeClose');\n            }, function () {\n                return _this10._option('beforeClose');\n            }, this._beforeClose, [this._unbindEvents, this.destroyComponents, function () {\n                return _this10._region._empty(_this10);\n            }], this._afterClose, function () {\n                return _this10._option('afterClose');\n            }, function () {\n                return _this10.trigger('afterClose');\n            }, function () {\n                return delete _this10._region;\n            }, this);\n        }\n    }, {\n        key: '_serializeData',\n        value: function _serializeData() {\n            return {\n                Global: this.app.global,\n                Self: this\n            };\n        }\n    }, {\n        key: '_renderTemplate',\n        value: function _renderTemplate(data) {\n            this._templateEngine._execute(this, data, this._template);\n        }\n    }, {\n        key: '_initializeEvents',\n        value: function _initializeEvents(events) {\n            var _this11 = this;\n\n            mapObj(events || this._option('events'), function (value, key) {\n                var items = key.replace(/(^\\s+)|(\\s+$)/g, '').split(/\\s+/),\n                    result = { key: key };\n\n                if (items.length !== 2) _this11._error('Invalid event key');\n                result.eventType = items[0];\n                if (items[1].slice(-1) === '*') {\n                    result.id = _this11._wrapDomId(items[1].slice(0, -1));\n                    result.haveStar = true;\n                    result.selector = '[id^=' + result.id + ']';\n                } else {\n                    result.id = _this11._wrapDomId(items[1]);\n                    result.selector = '#' + result.id;\n                }\n                result.handler = _this11._createEventHandler(value, result);\n                _this11._events[key] = result;\n            });\n        }\n    }, {\n        key: '_createEventHandler',\n        value: function _createEventHandler(handlerName, _ref3) {\n            var _this12 = this;\n\n            var haveStar = _ref3.haveStar;\n            var id = _ref3.id;\n            var disabledClass = this.app.options.disabledClass;\n\n            return function (event) {\n                if (!_this12._eventHandlers[handlerName]) _this12._error('No event handler for name:', handlerName);\n\n                var target = D.Adapter.getEventTarget(event),\n                    args = [event];\n                if (D.Adapter.hasClass(target, disabledClass)) return;\n                if (haveStar) args.unshift(target.getAttribute('id').slice(id.length));\n                _this12._eventHandlers[handlerName].apply(_this12, args);\n            };\n        }\n    }, {\n        key: '_bindEvents',\n        value: function _bindEvents() {\n            var _this13 = this;\n\n            mapObj(this._events, function (value) {\n                _this13._region._delegateDomEvent(_this13, value.eventType, value.selector, value.handler);\n            });\n        }\n    }, {\n        key: '_unbindEvents',\n        value: function _unbindEvents() {\n            this._region._undelegateDomEvents(this);\n        }\n    }, {\n        key: '_renderComponents',\n        value: function _renderComponents() {\n            var _this14 = this;\n\n            this.chain(map(this._option('components'), function (item) {\n                var i = D.isFunction(item) ? item.call(_this14) : item;\n                return i ? D.ComponentManager.create(_this14, i) : null;\n            }), function (components) {\n                return map(components, function (item) {\n                    if (!item) return;\n                    var id = item.id;\n                    var component = item.component;\n                    var index = item.index;var value = _this14.components[id];\n                    D.isArray(value) ? value.push(component) : _this14.components[id] = value ? [value, component] : component;\n                    _this14._componentMap[index] = item;\n                });\n            });\n        }\n    }, {\n        key: '_destroyComponents',\n        value: function _destroyComponents() {\n            var _this15 = this;\n\n            this.components = {};\n            mapObj(this._componentMap, function (value) {\n                return D.ComponentManager.destroy(_this15, value);\n            });\n        }\n    }, {\n        key: '_wrapDomId',\n        value: function _wrapDomId(id) {\n            return this.id + id;\n        }\n    }, {\n        key: '_beforeRender',\n        value: function _beforeRender() {}\n    }, {\n        key: '_afterRender',\n        value: function _afterRender() {}\n    }, {\n        key: '_beforeClose',\n        value: function _beforeClose() {}\n    }, {\n        key: '_afterClose',\n        value: function _afterClose() {}\n    }, {\n        key: '_element',\n        get: function get() {\n            return this._region ? this._region.getElement(this) : null;\n        }\n    }]);\n\n    return Renderable;\n}(D.Base);\n\nD.RenderableContainer = function (_D$Renderable) {\n    _inherits(RenderableContainer, _D$Renderable);\n\n    function RenderableContainer() {\n        _classCallCheck(this, RenderableContainer);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(RenderableContainer).apply(this, arguments));\n    }\n\n    _createClass(RenderableContainer, [{\n        key: '_initialize',\n        value: function _initialize() {\n            var promise = _get(Object.getPrototypeOf(RenderableContainer.prototype), '_initialize', this).call(this);\n\n            this._items = {};\n            return this.chain(promise, this._initializeItems);\n        }\n    }, {\n        key: '_afterRender',\n        value: function _afterRender() {\n            return this.chain(this._initializeRegions, this._renderItems);\n        }\n    }, {\n        key: '_afterClose',\n        value: function _afterClose() {\n            return this._closeRegions();\n        }\n    }, {\n        key: '_initializeItems',\n        value: function _initializeItems() {\n            var _this17 = this;\n\n            this.chain(mapObj(this._option('items'), function () {\n                var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n                var name = arguments[1];\n\n                var opt = D.isFunction(options) ? options.call(_this17) : options;\n                if (D.isString(opt)) opt = { region: opt };\n\n                return _this17.app[options.isModule ? '_createModule' : '_createView'](name, parent).then(function (item) {\n                    item.moduleOptions = options;\n                    _this17._items[name] = item;\n                    return item;\n                });\n            }));\n        }\n    }, {\n        key: '_initializeRegions',\n        value: function _initializeRegions() {\n            var _this18 = this;\n\n            this._regions = {};\n            return this.chain(this.closeRegions, map(this.$$('[data-region]'), function (el) {\n                var region = _this18._createRegion(el);\n                _this18._regions[region.name] = region;\n            }));\n        }\n    }, {\n        key: '_renderItems',\n        value: function _renderItems() {\n            var _this19 = this;\n\n            return this.chain(mapObj(this.items, function (item) {\n                var region = item.moduleOptions.region;\n\n                if (!region) return;\n                if (!_this19.regions[region]) _this19.error('Region: ' + region + ' is not defined');\n                _this19.regions[region].show(item);\n            }), this);\n        }\n    }, {\n        key: '_createRegion',\n        value: function _createRegion(el) {\n            var name = el.getAttribute('data-region');\n            return this.app._createRegion(el, name, this);\n        }\n    }, {\n        key: '_closeRegions',\n        value: function _closeRegions() {\n            var regions = this._regions;\n            if (!regions) return;\n            delete this._regions;\n            return this.chain(mapObj(regions, function (region) {\n                return region.close();\n            }));\n        }\n    }, {\n        key: 'items',\n        get: function get() {\n            return this._items || {};\n        }\n    }, {\n        key: 'regions',\n        get: function get() {\n            return this._regions || {};\n        }\n    }]);\n\n    return RenderableContainer;\n}(D.Renderable);\n\nD.ActionCreator = function (_D$Renderable2) {\n    _inherits(ActionCreator, _D$Renderable2);\n\n    function ActionCreator() {\n        _classCallCheck(this, ActionCreator);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(ActionCreator).apply(this, arguments));\n    }\n\n    _createClass(ActionCreator, [{\n        key: '_initializeEvents',\n        value: function _initializeEvents() {\n            _get(Object.getPrototypeOf(ActionCreator.prototype), '_initializeEvents', this).call(this);\n            _get(Object.getPrototypeOf(ActionCreator.prototype), '_initializeEvents', this).call(this, this._actions);\n        }\n    }, {\n        key: '_createEventHandler',\n        value: function _createEventHandler(name, obj) {\n            return (this._option('actions') || {})[obj.key] ? this._createAction(name) : _get(Object.getPrototypeOf(ActionCreator.prototype), '_createEventHandler', this).call(this, name, obj);\n        }\n    }, {\n        key: '_createAction',\n        value: function _createAction(name) {\n            var _this21 = this;\n\n            var disabledClass = this.app.options.disabledClass;\n\n            var _ref4 = this._option('dataForActions') || {};\n\n            var dataForAction = _ref4[name];\n\n            var _ref5 = this._option('actionCallbacks') || {};\n\n            var actionCallback = _ref5[name];\n\n            return function (e) {\n                var target = D.Adapter.getEventTarget(event);\n                if (D.Adapter.hasClass(target, disabledClass)) return;\n                D.Adapter.addClass(target, disabledClass);\n\n                var data = _this21._getActionPayload(target);\n                _this21.chain(D.isFunction(dataForAction) ? dataForAction.call(_this21, data, e) : data, function (payload) {\n                    return payload !== false ? _this21.module.dispatch(name, payload) : false;\n                }, function (result) {\n                    return result !== false ? actionCallback && actionCallback.call(_this21, result) : false;\n                }).then(function () {\n                    return D.Adapter.removeClass(target, disabledClass);\n                }, function () {\n                    return D.Adapter.removeClass(target, disabledClass);\n                });\n            };\n        }\n    }, {\n        key: '_getActionPayload',\n        value: function _getActionPayload(target) {\n            var rootEl = this._element;\n            var current = target,\n                targetName = false;\n            while (current && current !== rootEl && current.tagName !== 'FORM') {\n                current = current.parentNode;\n            }current || (current = rootEl);\n            var data = current.tagName === 'FORM' ? D.Adapter.getFormData(current) : {};\n            map(current.querySelectorAll('[data-name][data-value]'), function (item) {\n                if (item === target) {\n                    targetName = target.getAttribute('data-name');\n                    data[targetName] = target.getAttribute('data-value');\n                    return;\n                }\n\n                var name = item.getAttribute('data-name');\n                if (targetName && targetName === name) return;\n\n                var value = item.getAttribute('data-value'),\n                    v = data[name];\n                D.isArray(v) ? v.push(value) : data[name] = v == null ? value : [v, value];\n            });\n            return data;\n        }\n    }]);\n\n    return ActionCreator;\n}(D.Renderable);\n\nD.View = function (_D$ActionCreator) {\n    _inherits(View, _D$ActionCreator);\n\n    function View() {\n        _classCallCheck(this, View);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(View).apply(this, arguments));\n    }\n\n    _createClass(View, [{\n        key: '_initialize',\n        value: function _initialize() {\n            this.bindings = {};\n            return this.chain(_get(Object.getPrototypeOf(View.prototype), '_initialize', this).call(this), this._initializeDataBinding);\n        }\n    }, {\n        key: '_initializeDataBinding',\n        value: function _initializeDataBinding() {\n            var _this23 = this;\n\n            this._dataBinding = {};\n            mapObj(this._option('bindings'), function (value, key) {\n                var model = _this23.bindings[key] = _this23.module.store[key];\n                if (!model) _this23._error('No model:', key);\n\n                if (!value) return;\n                _this23._dataBinding[key] = { model: model, value: value, fn: function fn() {\n                        if (value === true && _this23._region) _this23.render(_this23.renderOptions);\n                        if (D.isString(value)) _this23._option(value);\n                    } };\n            });\n        }\n    }, {\n        key: '_bindData',\n        value: function _bindData() {\n            var _this24 = this;\n\n            mapObj(this._dataBinding, function (value) {\n                return _this24.listenTo(value.model, 'change', value.fn);\n            });\n        }\n    }, {\n        key: '_unbindData',\n        value: function _unbindData() {\n            this.stopListening();\n            this.bindings = {};\n        }\n    }, {\n        key: '_setRegion',\n        value: function _setRegion() {\n            var _get2;\n\n            for (var _len11 = arguments.length, args = Array(_len11), _key11 = 0; _key11 < _len11; _key11++) {\n                args[_key11] = arguments[_key11];\n            }\n\n            (_get2 = _get(Object.getPrototypeOf(View.prototype), '_setRegion', this)).call.apply(_get2, [this].concat(args));\n            this._bindData();\n        }\n    }, {\n        key: '_close',\n        value: function _close() {\n            var _get3;\n\n            for (var _len12 = arguments.length, args = Array(_len12), _key12 = 0; _key12 < _len12; _key12++) {\n                args[_key12] = arguments[_key12];\n            }\n\n            this.chain((_get3 = _get(Object.getPrototypeOf(View.prototype), '_close', this)).call.apply(_get3, [this].concat(args)), this._unbindData, this);\n        }\n    }, {\n        key: '_serializeData',\n        value: function _serializeData() {\n            var _this25 = this;\n\n            var data = _get(Object.getPrototypeOf(View.prototype), '_serializeData', this).call(this);\n            mapObj(this.bindings, function (value, key) {\n                return data[key] = value.get(true);\n            });\n            mapObj(this._option('dataForTemplate'), function (value, key) {\n                return data[key] = value.call(_this25, data);\n            });\n            return data;\n        }\n    }]);\n\n    return View;\n}(D.ActionCreator);\n\nD.Module = function (_D$RenderableContaine) {\n    _inherits(Module, _D$RenderableContaine);\n\n    function Module() {\n        _classCallCheck(this, Module);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(Module).apply(this, arguments));\n    }\n\n    _createClass(Module, [{\n        key: '_initialize',\n        value: function _initialize() {\n            this.app._modules[this.name + '--' + this.id] = this;\n            return _get(Object.getPrototypeOf(Module.prototype), '_initialize', this).call(this);\n        }\n    }, {\n        key: '_initializeStore',\n        value: function _initializeStore() {\n            this._store = this.app._createStore(this, this._option('store'));\n        }\n    }, {\n        key: '_afterClose',\n        value: function _afterClose() {\n            delete this.app._modules[this.name + '--' + this.id];\n            this._store._destory();\n            return _get(Object.getPrototypeOf(Module.prototype), '_afterClose', this).call(this);\n        }\n    }, {\n        key: '_beforeRender',\n        value: function _beforeRender() {\n            var _this27 = this;\n\n            return this.chain(_get(Object.getPrototypeOf(Module.prototype), '_beforeRender', this).call(this), function () {\n                return _this27._store._loadEagerModels();\n            });\n        }\n    }, {\n        key: '_afterRender',\n        value: function _afterRender() {\n            var _this28 = this;\n\n            return this.chain(_get(Object.getPrototypeOf(Module.prototype), '_afterRender', this).call(this), function () {\n                return _this28._store._loadLazyModels();\n            });\n        }\n    }, {\n        key: 'store',\n        get: function get() {\n            return this._store;\n        }\n    }]);\n\n    return Module;\n}(D.RenderableContainer);\n\nD.Region = function (_D$Base2) {\n    _inherits(Region, _D$Base2);\n\n    function Region(mod, el, name) {\n        _classCallCheck(this, Region);\n\n        var _this29 = _possibleConstructorReturn(this, Object.getPrototypeOf(Region).call(this, name || 'Region', {\n            app: mod.app,\n            _el: el,\n            module: mod\n        }));\n\n        if (!_this29._el) _this29.error('The DOM element for region is required');\n        return _this29;\n    }\n\n    _createClass(Region, [{\n        key: 'show',\n        value: function show(renderable) {\n            var _this30 = this;\n\n            var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n            if (this._isCurrent(renderable)) {\n                if (renderable.forceRender === false) return this.Promise.resolve(this._current);\n                return this._current._render(options, true);\n            }\n\n            return this.chain(D.isString(renderable) ? this.app._createModule(renderable) : renderable, function (item) {\n                if (!(item instanceof D.Renderable)) _this30.error('The item is expected to be an instance of Renderable');\n                return item;\n            }, [function (item) {\n                return _this30.chain(item._region && item._region.close(), item);\n            }, function () {\n                return _this30.close();\n            }], function (_ref6) {\n                var _ref7 = _slicedToArray(_ref6, 1);\n\n                var item = _ref7[0];\n\n                _this30._current = item;\n                _this30._getElement().setAttribute('data-current', item.module ? item.module.name + ':' + item.name : item.name);\n                return item._setRegion(_this30);\n            }, function (item) {\n                return item._render(options, false);\n            });\n        }\n    }, {\n        key: 'close',\n        value: function close() {\n            var _this31 = this;\n\n            return this.chain(this._current && this._current.close(), function () {\n                return delete _this31._current;\n            }, this);\n        }\n    }, {\n        key: '$$',\n        value: function $$(selector) {\n            return this._getElement().querySelectorAll(selector);\n        }\n    }, {\n        key: '_isCurrent',\n        value: function _isCurrent(renderable) {\n            if (!this._current) return false;\n            if (this._current.name === renderable) return true;\n            if (renderable && renderable.id === this._current.id) return true;\n            return false;\n        }\n    }, {\n        key: '_getElement',\n        value: function _getElement() {\n            return this._el;\n        }\n    }, {\n        key: '_empty',\n        value: function _empty() {\n            this._getElement().innerHTML = '';\n        }\n    }, {\n        key: '_delegateDomEvent',\n        value: function _delegateDomEvent(renderable, name, selector, fn) {\n            D.Adapter.delegateDomEvent(this, renderable, name, selector, fn);\n        }\n    }, {\n        key: '_undelegateDomEvents',\n        value: function _undelegateDomEvents(renderable) {\n            D.Adapter.undelegateDomEvents(this, renderable);\n        }\n    }]);\n\n    return Region;\n}(D.Base);\n\nD.TemplateEngine = function (_D$Base3) {\n    _inherits(TemplateEngine, _D$Base3);\n\n    function TemplateEngine(options) {\n        _classCallCheck(this, TemplateEngine);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(TemplateEngine).call(this, 'Template Engine', options, { _templateCache: {} }));\n    }\n\n    _createClass(TemplateEngine, [{\n        key: '_load',\n        value: function _load(renderable) {\n            var id = renderable.id;\n            if (this._templateCache[id]) return this._templateCache[id];\n            return this._templateCache[id] = this._option('load', renderable);\n        }\n    }, {\n        key: '_execute',\n        value: function _execute(renderable, data, template) {\n            return this._option('execute', renderable, data, renderable._element, template);\n        }\n    }]);\n\n    return TemplateEngine;\n}(D.Base);\n\nD.Store = function (_D$Base4) {\n    _inherits(Store, _D$Base4);\n\n    function Store(mod, options) {\n        _classCallCheck(this, Store);\n\n        var _this33 = _possibleConstructorReturn(this, Object.getPrototypeOf(Store).call(this, 'Store', options, {\n            app: mod.app,\n            module: mod,\n            _models: {}\n        }));\n\n        _this33._callbacks = _this33._option('callbacks');\n        _this33.app.delegateEvent(_this33);\n        return _this33;\n    }\n\n    _createClass(Store, [{\n        key: 'dispatch',\n        value: function dispatch(name, payload) {\n            var callback = undefined,\n                n = name,\n                p = payload;\n            if (D.isObject(n)) {\n                p = n.payload;\n                n = n.name;\n            }\n\n            callback = this._callbacks[n];\n            if (!callback) this.error('No action callback for name: ' + name);\n            return this.chain(callback.call(this._callbackContext, p));\n        }\n    }, {\n        key: '_initialize',\n        value: function _initialize() {\n            this._initializeModels();\n            this._callbackContext = Object.assign({\n                models: this.models,\n                module: this.module,\n                app: this.app\n            }, D.Request);\n        }\n    }, {\n        key: '_initializeModels',\n        value: function _initializeModels() {\n            var _this34 = this;\n\n            mapObj(this._option('models'), function (value, key) {\n                var v = (D.isFunction(value) ? value.call(_this34) : v) || {};\n                if (v.shared === true) {\n                    _this34._models[key] = _this34.app.viewport.store[key];\n                    return;\n                }\n                _this34._models[key] = _this34.app._createModel(_this34, v);\n            });\n        }\n    }, {\n        key: '_loadEagerModels',\n        value: function _loadEagerModels() {\n            return this.chain(mapObj(this._models, function (model) {\n                return model.options.autoLoad === true ? D.Request.get(model) : null;\n            }));\n        }\n    }, {\n        key: '_loadLazyModels',\n        value: function _loadLazyModels() {\n            return this.chain(mapObj(this._models, function (model) {\n                var autoLoad = model.options.autoLoad;\n\n                return autoLoad && autoLoad !== true ? D.Request.get(model) : null;\n            }));\n        }\n    }, {\n        key: '_destory',\n        value: function _destory() {\n            this.stopListening();\n        }\n    }, {\n        key: 'models',\n        get: function get() {\n            return this._models;\n        }\n    }]);\n\n    return Store;\n}(D.Base);\n\nD.Model = function (_D$Base5) {\n    _inherits(Model, _D$Base5);\n\n    function Model(store, options) {\n        _classCallCheck(this, Model);\n\n        var _this35 = _possibleConstructorReturn(this, Object.getPrototypeOf(Model).call(this, 'Model', options, {\n            app: store.module.app,\n            module: store.module,\n            store: store\n        }));\n\n        _this35._data = _this35._option('data') || {};\n        _this35._idKey = _this35._option('idKey') || _this35.app.options.idKey;\n        _this35._params = Object.assign({}, _this35._option('params'));\n        _this35.app.delegateEvent(_this35);\n        return _this35;\n    }\n\n    _createClass(Model, [{\n        key: 'set',\n        value: function set(data, trigger) {\n            var d = this._option('parse', data);\n            this._data = this.options.root ? d[this.options.root] : d;\n            if (trigger) this.changed();\n        }\n    }, {\n        key: 'get',\n        value: function get(cloneIt) {\n            return cloneIt ? clone(this._data) : this._data;\n        }\n    }, {\n        key: 'clear',\n        value: function clear(trigger) {\n            this._data = D.isArray(this._data) ? [] : {};\n            if (trigger) this.changed();\n        }\n    }, {\n        key: 'changed',\n        value: function changed() {\n            this.trigger('changed');\n        }\n    }, {\n        key: '_url',\n        value: function _url() {\n            return this._option('url') || '';\n        }\n    }, {\n        key: 'fullUrl',\n        get: function get() {\n            return D.Request._url(this);\n        }\n    }, {\n        key: 'params',\n        get: function get() {\n            return this._params;\n        }\n    }, {\n        key: 'data',\n        get: function get() {\n            return this._data;\n        }\n    }]);\n\n    return Model;\n}(D.Base);\n\nD.Loader = function (_D$Base6) {\n    _inherits(Loader, _D$Base6);\n\n    _createClass(Loader, null, [{\n        key: '_analyse',\n        value: function _analyse(name) {\n            if (!D.isString(name)) {\n                return { loader: null, name: name };\n            }\n\n            var args = name.split(':'),\n                loader = args.length > 1 ? args.shift() : null;\n\n            return { loader: loader, name: args.shift(), args: args };\n        }\n    }]);\n\n    function Loader(app, options) {\n        _classCallCheck(this, Loader);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(Loader).call(this, 'Loader', options, { app: app }));\n    }\n\n    _createClass(Loader, [{\n        key: 'loadResource',\n        value: function loadResource(path) {\n            var _this37 = this;\n\n            var _app$options = this.app.options;\n            var scriptRoot = _app$options.scriptRoot;\n            var getResource = _app$options.getResource;\n            var amd = _app$options.amd;\n            var fullPath = scriptRoot + '/' + path;\n\n            return this.Promise.create(function (resolve, reject) {\n                if (amd) {\n                    require([fullPath], function (obj) {\n                        return resolve(obj);\n                    }, function (e) {\n                        return reject(e);\n                    });\n                } else if (getResource) {\n                    resolve(getResource.call(_this37.app, fullPath));\n                } else {\n                    resolve(require('./' + fullPath));\n                }\n            });\n        }\n    }, {\n        key: 'loadModuleResource',\n        value: function loadModuleResource(mod, path) {\n            return this.loadResource(mod.name + '/' + path);\n        }\n    }, {\n        key: 'loadModule',\n        value: function loadModule(name) {\n            return this.loadResource(name + '/' + this.app.options.fileNames.module);\n        }\n    }, {\n        key: 'loadView',\n        value: function loadView(name, mod) {\n            return this.loadModuleResource(mod, '' + this.app.options.fileNames.view + name);\n        }\n    }, {\n        key: 'loadRouter',\n        value: function loadRouter(path) {\n            return this.loadResource(path + '/' + this.app.options.fileNames.router);\n        }\n    }]);\n\n    return Loader;\n}(D.Base);\n\nD.Application = function (_D$Base7) {\n    _inherits(Application, _D$Base7);\n\n    function Application(options) {\n        _classCallCheck(this, Application);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(Application).call(this, options && options.name || 'Application', Object.assign({\n            scriptRoot: 'app',\n            urlRoot: '',\n            urlSuffix: '',\n            caseSensitiveHash: false,\n            defaultRegion: root.document.body,\n            disabledClass: 'disabled',\n            attributesReferToId: ['for', 'data-target', 'data-parent'],\n            getResource: null,\n            idKey: 'id',\n            viewport: 'viewport',\n\n            fileNames: {\n                module: 'index',\n                view: 'view-',\n                router: 'router'\n            },\n\n            pagination: {\n                pageSize: 10,\n                pageKey: '_page',\n                pageSizeKey: '_pageSize',\n                recordCountKey: 'recordCount'\n            }\n        }, options), {\n            global: {},\n            _modules: {},\n            _loaders: {}\n        }));\n    }\n\n    _createClass(Application, [{\n        key: '_initialize',\n        value: function _initialize() {\n            this._templateEngine = this._option('templateEngine');\n            this.registerLoader('default', new D.Loader(), true);\n            this._region = this._createRegion(this._option('defaultRegion'), 'Region');\n        }\n    }, {\n        key: 'registerLoader',\n        value: function registerLoader(name, loader, isDefault) {\n            this.loaders[name] = loader;\n            if (isDefault) this._defaultLoader = loader;\n            return this;\n        }\n    }, {\n        key: 'start',\n        value: function start(defaultRouter) {\n            var _this39 = this;\n\n            return this.chain(this._region.show(this._option('viewport')), function (viewport) {\n                return _this39.viewport = viewport;\n            });\n        }\n    }, {\n        key: '_getLoader',\n        value: function _getLoader(name, mod) {\n            return name && this._loaders[name] || mod && mod._loader || this._defaultLoader;\n        }\n    }, {\n        key: '_createModule',\n        value: function _createModule(name, parent) {\n            var _this40 = this;\n\n            var _D$Loader$_analyse = D.Loader._analyse(name);\n\n            var moduleName = _D$Loader$_analyse.name;\n            var loaderName = _D$Loader$_analyse.loader;\n            var loader = this._getLoader(loaderName, parent);\n\n            return this.chain(loader.loadModule(moduleName), function () {\n                var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n                return typeCache.createModule(options.type, moduleName, _this40, parent, loader, options);\n            });\n        }\n    }, {\n        key: '_createView',\n        value: function _createView(name, mod) {\n            var _this41 = this;\n\n            var _D$Loader$_analyse2 = D.Loader._analyse(name);\n\n            var viewName = _D$Loader$_analyse2.name;\n            var loaderName = _D$Loader$_analyse2.loader;\n            var loader = this._getLoader(loaderName, mod);\n\n            return this.chain(loader.loadView(viewName, mod), function () {\n                var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n                return typeCache.createView(options.type, viewName, _this41, mod, loader, options);\n            });\n        }\n    }, {\n        key: '_createRegion',\n        value: function _createRegion(el, name, mod) {\n            var _D$Loader$_analyse3 = D.Loader._analyse(name);\n\n            var regionName = _D$Loader$_analyse3.name;\n            var type = _D$Loader$_analyse3.loader;\n\n            return typeCache.createRegion(type, mod, el, regionName);\n        }\n    }, {\n        key: '_createStore',\n        value: function _createStore(mod) {\n            var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n            return typeCache.createStore(options.type, mod, options);\n        }\n    }, {\n        key: '_createModel',\n        value: function _createModel(store) {\n            var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n            return typeCache.createModel(options.type, store, options);\n        }\n    }]);\n\n    return Application;\n}(D.Base);\n\nObject.assign(D.Application.prototype, D.Event);\n\nvar PUSH_STATE_SUPPORTED = root.history && 'pushState' in root.history;\nvar ROUTER_REGEXPS = [/:([\\w\\d]+)/g, '([^\\/]+)', /\\*([\\w\\d]+)/g, '(.*)'];\n\nvar Route = function () {\n    function Route(app, router, path, fn) {\n        _classCallCheck(this, Route);\n\n        var pattern = path.replace(ROUTER_REGEXPS[0], ROUTER_REGEXPS[1]).replace(ROUTER_REGEXPS[2], ROUTER_REGEXPS[3]);\n\n        this.pattern = new RegExp('^' + pattern + '$', app.options.caseSensitiveHash ? 'g' : 'gi');\n\n        this.app = app;\n        this.router = router;\n        this.path = path;\n        this.fn = fn;\n    }\n\n    _createClass(Route, [{\n        key: 'match',\n        value: function match(hash) {\n            this.pattern.lastIndex = 0;\n            return this.pattern.test(hash);\n        }\n    }, {\n        key: 'handle',\n        value: function handle(hash) {\n            var _router,\n                _this42 = this;\n\n            this.pattern.lastIndex = 0;\n            var args = this.pattern.exec(hash).slice(1),\n                handlers = this.router._getInterceptors(this.path);\n\n            handlers.push(this.fn);\n            return (_router = this.router).chain.apply(_router, _toConsumableArray(map(handlers, function (fn, i) {\n                return function (prev) {\n                    return fn.apply(_this42.router, i > 0 ? [prev].concat(args) : args);\n                };\n            })));\n        }\n    }]);\n\n    return Route;\n}();\n\nD.Router = function (_D$Base8) {\n    _inherits(Router, _D$Base8);\n\n    function Router(app) {\n        _classCallCheck(this, Router);\n\n        return _possibleConstructorReturn(this, Object.getPrototypeOf(Router).call(this, 'Router', {}, {\n            app: app,\n            _routes: [],\n            _routeMap: {},\n            _interceptors: {}\n        }));\n    }\n\n    _createClass(Router, [{\n        key: '_initialize',\n        value: function _initialize() {}\n    }, {\n        key: '_getHash',\n        value: function _getHash() {\n            return root.location.hash.slice(1);\n        }\n    }]);\n\n    return Router;\n}(D.Base);\nreturn Drizzle;\n}));\n","/*!\n * DrizzleJS v0.3.18\n * -------------------------------------\n * Copyright (c) 2016 Jaco Koo <jaco.koo@guyong.in>\n * Distributed under MIT license\n */\n\nconst Drizzle = {},\n    D = Drizzle,\n    slice = [].slice,\n    EMPTY = function() {},\n\n    map = function(arr, fn) {\n        const result = [];\n        if (!arr) return result;\n        if (arr.map) return arr.map(fn);\n\n        for (let i = 0; i < arr.length; i ++) {\n            result.push(fn(arr[i], i, arr));\n        }\n        return result;\n    },\n\n    mapObj = function(obj, fn) {\n        const result = [];\n        let key;\n        if (!obj) return result;\n\n        for (key in obj) {\n            if (D.hasOwnProperty.call(obj, key)) result.push(fn(obj[key], key, obj));\n        }\n\n        return result;\n    },\n\n    clone = function(target) {\n        if (D.isObject(target)) {\n            const result = {};\n            mapObj(target, function(value, key) {\n                result[key] = clone(value);\n            });\n            return result;\n        }\n\n        if (D.isArray(target)) {\n            return map(target, function(value) {\n                return clone(value);\n            });\n        }\n\n        return target;\n    },\n\n    typeCache = {\n        View: {}, Region: {}, Module: {}, Model: {},\n\n        register (type, name, clazz) {\n            this[type][name] = clazz;\n        },\n\n        create (type, name, ...args) {\n            const Clazz = this[type][name] || D[type];\n            return new Clazz(...args);\n        }\n    };\n\nlet counter = 0;\n\nmap(['Function', 'Array', 'String', 'Object'], (item) => {\n    D[`is${item}`] = function(obj) {\n        return D.toString.call(obj) === `[object ${item}]`;\n    };\n});\n\nmap(['Module', 'View', 'Region', 'Model', 'Store'], (item) => {\n    D['register' + item] = (name, clazz) => typeCache.register(item, name, clazz);\n    typeCache['create' + item] = (name, ...args) => typeCache.create(item, name, ...args);\n});\n\nObject.assign(D, {\n    uniqueId (prefix = '') {\n        return `${prefix}${++counter}`;\n    },\n\n    adapt (obj) {\n        Object.assign(D.Adapter, obj);\n    }\n});\n\nconst __events = {};\nconst __createHandler = function(region, name, selector) {\n    return (e) => {\n        const target = e.target;\n        let matched = false;\n        map(region.getElement().querySelectorAll(selector), (el) => {\n            if (el === target || el.contains(target)) {\n                matched = el;\n            }\n        });\n\n        matched && region.trigger(name, e);\n    };\n};\nconst __captures = ['blur', 'focus', 'scroll', 'resize'];\n\nD.Adapter = {\n    Promise,\n\n    ajax (params) { throw new Error('Ajax is not implemented'); },\n\n    ajaxResult (args) { return args[0]; },\n\n    getEventTarget (e) { return e.currentTarget || e.target; },\n\n    getFormData (el) {\n\n    },\n\n    delegateDomEvent (region, renderable, name, selector, fn) {\n        const event = `${name}-${region.id}`, id = `${region.id}-${renderable.id}`;\n        renderable.listenTo(region, event, fn);\n        (__events[id] || (__events[id] = {}));\n        const handler = __events[id][name] = __createHandler(region, event, selector);\n        region.getElement().addEventListener(name, handler, __captures.indexOf(name) !== -1);\n    },\n\n    undelegateDomEvents (region, renderable) {\n        const id = `${region.id}-${renderable.id}`;\n        renderable.stopListening(region);\n        mapObj(__events[id], (handler, name) => {\n            region.getElement.removeEventListener(name, handler);\n        });\n        delete __events[id];\n    },\n\n    hasClass (el, clazz) { return el.classList.contains(clazz); },\n\n    addClass (el, clazz) { el.classList.add(clazz); },\n\n    removeClass (el, clazz) { el.classList.remove(clazz); }\n};\n\nD.Promise = class Promiser {\n    constructor (context) {\n        this.context = context;\n    }\n\n    create (fn) {\n        return new D.Adapter.Promise((resolve, reject) => {\n            fn.call(this.context, resolve, reject);\n        });\n    }\n\n    resolve (data) {\n        return D.Adapter.Promise.resolve(data);\n    }\n\n    reject (data) {\n        return D.Adapter.Promise.reject(data);\n    }\n\n    parallel (items, ...args) {\n        return this.create((resolve, reject) => {\n            const result = [], thenables = [], indexMap = {};\n            map(items, (item, i) => {\n                const value = D.isFunction(item) ? item.apply(this.context, args) : item;\n                if (value && value.then) {\n                    indexMap[thenables.length] = i;\n                    thenables.push(value);\n                } else {\n                    result[i] = value;\n                }\n            });\n\n            if (thenables.length === 0) return resolve(result);\n\n            D.Adapter.Promise.all(thenables).then((as) => {\n                mapObj(indexMap, (key, value) => result[value] = as[key]);\n                resolve(result);\n            }, (as) => {\n                reject(as);\n            });\n        });\n    }\n\n    chain (...args) {\n        let prev = null;\n        const doRing = (rings, ring, resolve, reject) => {\n            const nextRing = (data) => {\n                prev = data;\n                rings.length === 0 ? resolve(prev) : doRing(rings, rings.shift(), resolve, reject);\n            };\n\n            if (D.isArray(ring)) {\n                ring.length === 0 ? nextRing([]) :\n                    this.parallel(ring, ...(prev != null ? [prev] : [])).then(nextRing, reject);\n            } else {\n                const value = D.isFunction(ring) ? ring.apply(this.context, prev != null ? [prev] : []) : ring;\n                value && value.then ? value.then(nextRing, reject) : nextRing(value);\n            }\n        };\n\n        if (args.length === 0) return this.resolve();\n\n        return this.create((resolve, reject) => {\n            doRing(args, resolve, reject, args.shift(), 0);\n        });\n    }\n};\n\nD.Event = {\n    on (name, fn, ctx) {\n        this._events || (this._events = {});\n        (this._events[name] || (this._events[name] = [])).push({ fn, ctx });\n    },\n\n    off (name, fn) {\n        if (!this._events || !name || !this._events[name]) return;\n        if (!fn) return delete this._events[name];\n\n        const result = [];\n        map(this._events[name], (item) => {if (item.fn !== fn) result.push(item);});\n\n        if (result.length === 0) return (delete this._events[name]);\n        this._events[name] = result;\n    },\n\n    trigger (name, ...args) {\n        if (!name || !this._events || !this._events[name]) return this;\n        map(this._events[name], (item) => item.fn.apply(item.ctx, args));\n    },\n\n    delegateEvent (to) {\n        const me = this, id = '--' + to.id, target = to;\n\n        Object.assign(target, {\n            _listeners: {},\n\n            listenTo (obj, name, fn) {\n                (target._listeners[name] || (target._listeners[name] = [])).push({ fn, obj });\n                obj.on(name, fn, target);\n            },\n\n            stopListening (obj, name, fn) {\n                if (!obj) {\n                    mapObj(target._listeners, (value, key) => map(value, (item) => item.obj.off(key, item.fn)));\n                    target._listeners = {};\n                    return;\n                }\n\n                if (!name) {\n                    mapObj(target._listeners, (value, key) => map(value, (item) => me.off(key, item)));\n                    target._listeners = {};\n                    return;\n                }\n\n                const result = [];\n                map(target._listeners[name], (item) => fn && fn !== item ? result.push(item) : me.off(name, item));\n                target._listeners[name] = result;\n\n                if (result.length === 0) delete target._listeners[name];\n            },\n\n            on (name, fn, context) {\n                target.listenTo(me, name + id, context);\n            },\n\n            off (name, fn) {\n                target.stopListening(me, (name && name + id), fn);\n            },\n\n            trigger (name, ...args) {\n                if (!name) return target;\n                args.unshift(name + id) && me.trigger(...args);\n            }\n        });\n        return this;\n    }\n};\n\nD.Request = {\n    get (model, options) {\n        return this._ajax('GET', model, model.params, options);\n    },\n\n    post (model, options) {\n        return this._ajax('POST', model, model.data, options);\n    },\n\n    put (model, options) {\n        return this._ajax('PUT', model, model.data, options);\n    },\n\n    del (model, options) {\n        return this._ajax('DELETE', model, model.data, options);\n    },\n\n    save (model, options) {\n        return model.data && model.data[model._idKey] ? this.put(model, options) : this.post(model, options);\n    },\n\n    _url (model) {\n        const parts = [],\n            prefix = model.module._option('urlPrefix', model) || '',\n            urlRoot = model.app._option('urlRoot', model) || '',\n            urlSuffix = model.app._option('urlSuffix', model) || '';\n        let base = model._url() || '';\n\n        urlRoot && parts.push(urlRoot);\n        prefix && parts.push(prefix);\n        parts.push(model.module.name);\n\n        while (base.indexOf('../') === 0) {\n            parts.pop();\n            base = base.slice(3);\n        }\n\n        base && parts.push(base);\n        model.data && model.data[model._idKey] && parts.push(model.data[model._idKey]);\n        urlSuffix && parts.push(urlSuffix);\n\n        return parts.join('/');\n    },\n\n    _ajax (method, model, data, options) {\n        const params = Object.assign({ type: method }, options);\n\n        params.data = Object.assign({}, data, params.data);\n        params.url = this._url(model);\n\n        return D.Promise.create((resolve, reject) => {\n            D.Adapter.ajax(params).then((...args) => {\n                model.set(D.Adapter.ajaxResult(args), !params.slient);\n                resolve(args);\n            }, (...args) => reject(args));\n        });\n    }\n};\n\nD.ComponentManager = {\n    _handlers: {},\n    _componentCache: {},\n\n    setDefaultHandler (creator, destructor = EMPTY) {\n        this._defaultHandler = { creator, destructor };\n    },\n\n    register (name, creator, destructor) {\n        this.handlers[name] = { creator, destructor: destructor || EMPTY };\n    },\n\n    _create (renderable, options) {\n        const { name, id, selector, options: opt } = options;\n        if (!name) renderable.error('Component name can not be null');\n\n        const handler = this._handlers[name] || this._defaultHandler;\n        if (!handler) renderable.error('No handler for component:', name);\n\n        const dom = selector ? renderable.$$(selector) : renderable.$(id);\n        const uid = id ? id : D.uniqueId('comp');\n\n        return renderable.chain(handler.creator(renderable, dom, opt), (component) => {\n            const cid = renderable.id + uid,\n                cache = this._componentCache[cid],\n                obj = { id: cid, handler, index: D.uniqueId(cid), options: opt };\n\n            D.isArray(cache) ? cache.push(obj) : this._componentCache[cid] = cache ? [cache, obj] : obj;\n            return { id, component, index: obj.index };\n        });\n    },\n\n    _destroy (renderable, obj) {\n        const id = renderable.id + obj.id, cache = this._componentCache[id];\n        let current = cache;\n\n        if (D.isArray(cache)) {\n            this._componentCache[id] = [];\n            map(cache, (item) => {\n                item.index !== obj.index ? this._componentCache[id].push(item) : current = item;\n            });\n            this._componentCache[id].length === 0 && delete this._componentCache[id];\n        } else {\n            delete this._componentCache[id];\n        }\n\n        current.handler.destructor(renderable, obj.component, current.options);\n    }\n};\n\nD.Base = class Base {\n    constructor (name, options = {}, defaults) {\n        this.options = options;\n        this.id = D.uniqueId('D');\n        this.name = name;\n        this.Promise = new D.Promise(this);\n\n        Object.assign(this, defaults);\n        if (options.mixin) this._mixin(options.mixin);\n        this._loadedPromise = this._initialize();\n    }\n\n    _initialize () {\n    }\n\n    _option (key, ...args) {\n        const value = this.options[key];\n        return D.isFunction(value) ? value.apply(this, args) : value;\n    }\n\n    _error (message, ...rest) {\n        if (!D.isString(message)) throw message;\n        throw new Error(`[${this.module ? this.module.name + ':' : ''}${this.name}] ${message} ${rest.join(' ')}`);\n    }\n\n    _mixin (obj) {\n        mapObj(obj, (value, key) => {\n            const old = this[key];\n            if (!old) {\n                this[key] = value;\n                return;\n            }\n\n            if (D.isFunction(old)) {\n                this[key] = () => {\n                    const args = slice.call(arguments);\n                    args.unshift(old);\n                    return value.apply(this, args);\n                };\n            }\n        });\n    }\n\n    chain (...args) {\n        return this.Promise.chain(...args);\n    }\n};\n\nD.Renderable = class Renderable extends D.Base {\n    constructor (name, app, mod, loader, options) {\n        super(name, options, {\n            app,\n            module: mod,\n            components: {},\n            _loader: loader,\n            _componentMap: {},\n            _events: {}\n        });\n        this._eventHandlers = this._option('handlers');\n        this._templateEngine = this._option('templateEngine') || mod && mod._templateEngine || app._templateEngine;\n        app.delegateEvent(this);\n    }\n\n    _initialize () {\n        return this.chain(\n            [this._templateEngine._load(this), this._initializeEvents()],\n            ([template]) => this._template = template\n        );\n    }\n\n    render (options) {\n        return this._render(options, true);\n    }\n\n    $ (id) {\n        return this.$$('#' + this._wrapDomId(id))[0];\n    }\n\n    $$ (selector) {\n        return this._element.querySelectorAll(selector);\n    }\n\n    _render (options = {}, update) {\n        if (!this.region) this.error('Region is null');\n\n        this.renderOptions = options;\n        return this.chain(\n            this._loadedPromise,\n            this._destroyComponents,\n            () => this.trigger('beforeRender'),\n            () => this._option('beforeRender'),\n            this._beforeRender,\n            this._serializeData,\n            this._renderTemplate,\n            this._renderComponents,\n            this._afterRender,\n            () => this._option('afterRender'),\n            () => this.trigger('afterRender'),\n            this\n        );\n    }\n\n    _setRegion (region) {\n        this._region = region;\n        this._bindEvents();\n    }\n\n    _close () {\n        if (!this._region) return this.Promise.resolve(this);\n\n        return this.chain(\n            () => this.trigger('beforeClose'),\n            () => this._option('beforeClose'),\n            this._beforeClose,\n            [this._unbindEvents, this.destroyComponents, () => this._region._empty(this)],\n            this._afterClose,\n            () => this._option('afterClose'),\n            () => this.trigger('afterClose'),\n            () => delete this._region,\n            this\n        );\n    }\n\n    get _element () {\n        return this._region ? this._region.getElement(this) : null;\n    }\n\n    _serializeData () {\n        return {\n            Global: this.app.global,\n            Self: this\n        };\n    }\n\n    _renderTemplate (data) {\n        this._templateEngine._execute(this, data, this._template);\n    }\n\n    _initializeEvents (events) {\n        mapObj(events || this._option('events'), (value, key) => {\n            const items = key.replace(/(^\\s+)|(\\s+$)/g, '').split(/\\s+/), result = { key };\n\n            if (items.length !== 2) this._error('Invalid event key');\n            result.eventType = items[0];\n            if (items[1].slice(-1) === '*') {\n                result.id = this._wrapDomId(items[1].slice(0, -1));\n                result.haveStar = true;\n                result.selector = `[id^=${result.id}]`;\n            } else {\n                result.id = this._wrapDomId(items[1]);\n                result.selector = `#${result.id}`;\n            }\n            result.handler = this._createEventHandler(value, result);\n            this._events[key] = result;\n        });\n    }\n\n    _createEventHandler (handlerName, { haveStar, id }) {\n        const { disabledClass } = this.app.options;\n        return (event) => {\n            if (!this._eventHandlers[handlerName]) this._error('No event handler for name:', handlerName);\n\n            const target = D.Adapter.getEventTarget(event), args = [event];\n            if (D.Adapter.hasClass(target, disabledClass)) return;\n            if (haveStar) args.unshift(target.getAttribute('id').slice(id.length));\n            this._eventHandlers[handlerName].apply(this, args);\n        };\n    }\n\n    _bindEvents () {\n        mapObj(this._events, (value) => {\n            this._region._delegateDomEvent(this, value.eventType, value.selector, value.handler);\n        });\n    }\n\n    _unbindEvents () {\n        this._region._undelegateDomEvents(this);\n    }\n\n    _renderComponents () {\n        this.chain(map(this._option('components'), (item) => {\n            const i = D.isFunction(item) ? item.call(this) : item;\n            return i ? D.ComponentManager.create(this, i) : null;\n        }), (components) => map(components, (item) => {\n            if (!item) return;\n            const { id, component, index } = item, value = this.components[id];\n            D.isArray(value) ? value.push(component) : (this.components[id] = value ? [value, component] : component);\n            this._componentMap[index] = item;\n        }));\n    }\n\n    _destroyComponents () {\n        this.components = {};\n        mapObj(this._componentMap, (value) => D.ComponentManager.destroy(this, value));\n    }\n\n    _wrapDomId (id) {\n        return this.id + id;\n    }\n\n    _beforeRender () {}\n    _afterRender () {}\n    _beforeClose () {}\n    _afterClose () {}\n};\n\nD.RenderableContainer = class RenderableContainer extends D.Renderable {\n\n    get items () {\n        return this._items || {};\n    }\n\n    get regions () {\n        return this._regions || {};\n    }\n\n    _initialize () {\n        const promise = super._initialize();\n\n        this._items = {};\n        return this.chain(promise, this._initializeItems);\n    }\n\n    _afterRender () {\n        return this.chain(this._initializeRegions, this._renderItems);\n    }\n\n    _afterClose () {\n        return this._closeRegions();\n    }\n\n    _initializeItems () {\n        this.chain(mapObj(this._option('items'), (options = {}, name) => {\n            let opt = D.isFunction(options) ? options.call(this) : options;\n            if (D.isString(opt)) opt = { region: opt };\n\n            return this.app[options.isModule ? '_createModule' : '_createView'](name, parent).then((item) => {\n                item.moduleOptions = options;\n                this._items[name] = item;\n                return item;\n            });\n        }));\n    }\n\n    _initializeRegions () {\n        this._regions = {};\n        return this.chain(this.closeRegions, map(this.$$('[data-region]'), (el) => {\n            const region = this._createRegion(el);\n            this._regions[region.name] = region;\n        }));\n    }\n\n    _renderItems () {\n        return this.chain(mapObj(this.items, (item) => {\n            const { region } = item.moduleOptions;\n            if (!region) return;\n            if (!this.regions[region]) this.error(`Region: ${region} is not defined`);\n            this.regions[region].show(item);\n        }), this);\n    }\n\n    _createRegion (el) {\n        const name = el.getAttribute('data-region');\n        return this.app._createRegion(el, name, this);\n    }\n\n    _closeRegions () {\n        const regions = this._regions;\n        if (!regions) return;\n        delete this._regions;\n        return this.chain(mapObj(regions, (region) => region.close()));\n    }\n};\n\nD.ActionCreator = class ActionCreator extends D.Renderable {\n    _initializeEvents () {\n        super._initializeEvents();\n        super._initializeEvents(this._actions);\n    }\n\n    _createEventHandler (name, obj) {\n        return (this._option('actions') || {})[obj.key] ? this._createAction(name) : super._createEventHandler(name, obj);\n    }\n\n    _createAction (name) {\n        const { disabledClass } = this.app.options,\n            { [name]: dataForAction } = this._option('dataForActions') || {},\n            { [name]: actionCallback } = this._option('actionCallbacks') || {};\n\n        return (e) => {\n            const target = D.Adapter.getEventTarget(event);\n            if (D.Adapter.hasClass(target, disabledClass)) return;\n            D.Adapter.addClass(target, disabledClass);\n\n            const data = this._getActionPayload(target);\n            this.chain(\n                D.isFunction(dataForAction) ? dataForAction.call(this, data, e) : data,\n                (payload) => payload !== false ? this.module.dispatch(name, payload) : false,\n                (result) => result !== false ? actionCallback && actionCallback.call(this, result) : false\n            ).then(() => D.Adapter.removeClass(target, disabledClass), () => D.Adapter.removeClass(target, disabledClass));\n        };\n    }\n\n    _getActionPayload (target) {\n        const rootEl = this._element;\n        let current = target, targetName = false;\n        while (current && current !== rootEl && current.tagName !== 'FORM') current = current.parentNode;\n\n        current || (current = rootEl);\n        const data = current.tagName === 'FORM' ? D.Adapter.getFormData(current) : {};\n        map(current.querySelectorAll('[data-name][data-value]'), (item) => {\n            if (item === target) {\n                targetName = target.getAttribute('data-name');\n                data[targetName] = target.getAttribute('data-value');\n                return;\n            }\n\n            const name = item.getAttribute('data-name');\n            if (targetName && targetName === name) return;\n\n            const value = item.getAttribute('data-value'), v = data[name];\n            D.isArray(v) ? v.push(value) : (data[name] = v == null ? value : [v, value]);\n        });\n        return data;\n    }\n};\n\nD.View = class View extends D.ActionCreator {\n    _initialize () {\n        this.bindings = {};\n        return this.chain(super._initialize(), this._initializeDataBinding);\n    }\n\n    _initializeDataBinding () {\n        this._dataBinding = {};\n        mapObj(this._option('bindings'), (value, key) => {\n            const model = this.bindings[key] = this.module.store[key];\n            if (!model) this._error('No model:', key);\n\n            if (!value) return;\n            this._dataBinding[key] = { model, value, fn: () => {\n                if (value === true && this._region) this.render(this.renderOptions);\n                if (D.isString(value)) this._option(value);\n            } };\n        });\n    }\n\n    _bindData () {\n        mapObj(this._dataBinding, (value) => this.listenTo(value.model, 'change', value.fn));\n    }\n\n    _unbindData () {\n        this.stopListening();\n        this.bindings = {};\n    }\n\n    _setRegion (...args) {\n        super._setRegion(...args);\n        this._bindData();\n    }\n\n    _close (...args) {\n        this.chain(super._close(...args), this._unbindData, this);\n    }\n\n    _serializeData () {\n        const data = super._serializeData();\n        mapObj(this.bindings, (value, key) => data[key] = value.get(true));\n        mapObj(this._option('dataForTemplate'), (value, key) => data[key] = value.call(this, data));\n        return data;\n    }\n\n};\n\nD.Module = class Module extends D.RenderableContainer {\n    _initialize () {\n        this.app._modules[`${this.name}--${this.id}`] = this;\n        return super._initialize();\n    }\n\n    get store () {\n        return this._store;\n    }\n\n    _initializeStore () {\n        this._store = this.app._createStore(this, this._option('store'));\n    }\n\n    _afterClose () {\n        delete this.app._modules[`${this.name}--${this.id}`];\n        this._store._destory();\n        return super._afterClose();\n    }\n\n    _beforeRender () {\n        return this.chain(super._beforeRender(), () => this._store._loadEagerModels());\n    }\n\n    _afterRender () {\n        return this.chain(super._afterRender(), () => this._store._loadLazyModels());\n    }\n};\n\nD.Region = class Region extends D.Base {\n    constructor (mod, el, name) {\n        super(name || 'Region', {\n            app: mod.app,\n            _el: el,\n            module: mod\n        });\n\n        if (!this._el) this.error('The DOM element for region is required');\n    }\n\n    show (renderable, options = {}) {\n        if (this._isCurrent(renderable)) {\n            if (renderable.forceRender === false) return this.Promise.resolve(this._current);\n            return this._current._render(options, true);\n        }\n\n        return this.chain(\n            D.isString(renderable) ? this.app._createModule(renderable) : renderable,\n            (item) => {\n                if (!(item instanceof D.Renderable)) this.error('The item is expected to be an instance of Renderable');\n                return item;\n            }, [\n                (item) => this.chain(item._region && item._region.close(), item),\n                () => this.close()\n            ],\n            ([item]) => {\n                this._current = item;\n                this._getElement().setAttribute('data-current', item.module ? `${item.module.name}:${item.name}` : item.name);\n                return item._setRegion(this);\n            },\n            (item) => item._render(options, false)\n        );\n    }\n\n    close () {\n        return this.chain(\n            this._current && this._current.close(),\n            () => delete this._current,\n            this\n        );\n    }\n\n    $$ (selector) {\n        return this._getElement().querySelectorAll(selector);\n    }\n\n    _isCurrent (renderable) {\n        if (!this._current) return false;\n        if (this._current.name === renderable) return true;\n        if (renderable && renderable.id === this._current.id) return true;\n        return false;\n    }\n\n    _getElement () {\n        return this._el;\n    }\n\n    _empty () {\n        this._getElement().innerHTML = '';\n    }\n\n    _delegateDomEvent (renderable, name, selector, fn) {\n        D.Adapter.delegateDomEvent(this, renderable, name, selector, fn);\n    }\n\n    _undelegateDomEvents (renderable) {\n        D.Adapter.undelegateDomEvents(this, renderable);\n    }\n};\n\nD.TemplateEngine = class TemplateEngine extends D.Base {\n    constructor (options) {\n        super('Template Engine', options, { _templateCache: {} });\n    }\n\n    _load (renderable) {\n        const id = renderable.id;\n        if (this._templateCache[id]) return this._templateCache[id];\n        return this._templateCache[id] = this._option('load', renderable);\n    }\n\n    _execute (renderable, data, template) {\n        return this._option('execute', renderable, data, renderable._element, template);\n    }\n};\n\nD.Store = class Store extends D.Base {\n    constructor (mod, options) {\n        super('Store', options, {\n            app: mod.app,\n            module: mod,\n            _models: {}\n        });\n        this._callbacks = this._option('callbacks');\n        this.app.delegateEvent(this);\n    }\n\n    get models () {return this._models;}\n\n    dispatch (name, payload) {\n        let callback, n = name, p = payload;\n        if (D.isObject(n)) {\n            p = n.payload;\n            n = n.name;\n        }\n\n        callback = this._callbacks[n];\n        if (!callback) this.error(`No action callback for name: ${name}`);\n        return this.chain(callback.call(this._callbackContext, p));\n    }\n\n    _initialize () {\n        this._initializeModels();\n        this._callbackContext = Object.assign({\n            models: this.models,\n            module: this.module,\n            app: this.app\n        }, D.Request);\n    }\n\n    _initializeModels () {\n        mapObj(this._option('models'), (value, key) => {\n            const v = (D.isFunction(value) ? value.call(this) : v) || {};\n            if (v.shared === true) {\n                this._models[key] = this.app.viewport.store[key];\n                return;\n            }\n            this._models[key] = this.app._createModel(this, v);\n        });\n    }\n\n    _loadEagerModels () {\n        return this.chain(mapObj(this._models, (model) => {\n            return model.options.autoLoad === true ? D.Request.get(model) : null;\n        }));\n    }\n\n    _loadLazyModels () {\n        return this.chain(mapObj(this._models, (model) => {\n            const { autoLoad } = model.options;\n            return autoLoad && autoLoad !== true ? D.Request.get(model) : null;\n        }));\n    }\n\n    _destory () {\n        this.stopListening();\n    }\n};\n\nD.Model = class Model extends D.Base {\n    constructor (store, options) {\n        super('Model', options, {\n            app: store.module.app,\n            module: store.module,\n            store\n        });\n\n        this._data = this._option('data') || {};\n        this._idKey = this._option('idKey') || this.app.options.idKey;\n        this._params = Object.assign({}, this._option('params'));\n        this.app.delegateEvent(this);\n    }\n\n    get fullUrl () { return D.Request._url(this); }\n\n    get params () { return this._params; }\n\n    get data () { return this._data; }\n\n    set (data, trigger) {\n        const d = this._option('parse', data);\n        this._data = this.options.root ? d[this.options.root] : d;\n        if (trigger) this.changed();\n    }\n\n    get (cloneIt) {\n        return cloneIt ? clone(this._data) : this._data;\n    }\n\n    clear (trigger) {\n        this._data = D.isArray(this._data) ? [] : {};\n        if (trigger) this.changed();\n    }\n\n    changed () { this.trigger('changed'); }\n\n    _url () {\n        return this._option('url') || '';\n    }\n};\n\nD.Loader = class Loader extends D.Base {\n    static _analyse (name) {\n        if (!D.isString(name)) {\n            return { loader: null, name };\n        }\n\n        const args = name.split(':'),\n            loader = args.length > 1 ? args.shift() : null;\n\n        return { loader, name: args.shift(), args };\n    }\n\n    constructor (app, options) {\n        super('Loader', options, { app });\n    }\n\n    loadResource (path) {\n        const { scriptRoot, getResource, amd } = this.app.options,\n            fullPath = `${scriptRoot}/${path}`;\n\n        return this.Promise.create((resolve, reject) => {\n            if (amd) {\n                require([fullPath], (obj) => resolve(obj), (e) => reject(e));\n            } else if (getResource) {\n                resolve(getResource.call(this.app, fullPath));\n            } else {\n                resolve(require(`./${fullPath}`));\n            }\n        });\n    }\n\n    loadModuleResource (mod, path) {\n        return this.loadResource(`${mod.name}/${path}`);\n    }\n\n    loadModule (name) {\n        return this.loadResource(`${name}/${this.app.options.fileNames.module}`);\n    }\n\n    loadView (name, mod) {\n        return this.loadModuleResource(mod, `${this.app.options.fileNames.view}${name}`);\n    }\n\n    loadRouter (path) {\n        return this.loadResource(`${path}/${this.app.options.fileNames.router}`);\n    }\n};\n\nD.Application = class Application extends D.Base {\n    constructor (options) {\n        super(options && options.name || 'Application', Object.assign({\n            scriptRoot: 'app',\n            urlRoot: '',\n            urlSuffix: '',\n            caseSensitiveHash: false,\n            defaultRegion: root.document.body,\n            disabledClass: 'disabled',\n            attributesReferToId: ['for', 'data-target', 'data-parent'],\n            getResource: null,\n            idKey: 'id',\n            viewport: 'viewport',\n\n            fileNames: {\n                module: 'index',\n                view: 'view-',\n                router: 'router'\n            },\n\n            pagination: {\n                pageSize: 10,\n                pageKey: '_page',\n                pageSizeKey: '_pageSize',\n                recordCountKey: 'recordCount'\n            }\n        }, options), {\n            global: {},\n            _modules: {},\n            _loaders: {}\n        });\n    }\n\n    _initialize () {\n        this._templateEngine = this._option('templateEngine');\n        this.registerLoader('default', new D.Loader(), true);\n        this._region = this._createRegion(this._option('defaultRegion'), 'Region');\n    }\n\n    registerLoader (name, loader, isDefault) {\n        this.loaders[name] = loader;\n        if (isDefault) this._defaultLoader = loader;\n        return this;\n    }\n\n    start (defaultRouter) {\n        return this.chain(\n            this._region.show(this._option('viewport')),\n            (viewport) => this.viewport = viewport\n        );\n    }\n\n    _getLoader (name, mod) {\n        return name && this._loaders[name] || mod && mod._loader || this._defaultLoader;\n    }\n\n    _createModule (name, parent) {\n        const { name: moduleName, loader: loaderName } = D.Loader._analyse(name),\n            loader = this._getLoader(loaderName, parent);\n\n        return this.chain(loader.loadModule(moduleName), (options = {}) => {\n            return typeCache.createModule(options.type, moduleName, this, parent, loader, options);\n        });\n    }\n\n    _createView (name, mod) {\n        const { name: viewName, loader: loaderName } = D.Loader._analyse(name),\n            loader = this._getLoader(loaderName, mod);\n\n        return this.chain(loader.loadView(viewName, mod), (options = {}) => {\n            return typeCache.createView(options.type, viewName, this, mod, loader, options);\n        });\n    }\n\n    _createRegion (el, name, mod) {\n        const { name: regionName, loader: type } = D.Loader._analyse(name);\n        return typeCache.createRegion(type, mod, el, regionName);\n    }\n\n    _createStore (mod, options = {}) {\n        return typeCache.createStore(options.type, mod, options);\n    }\n\n    _createModel (store, options = {}) {\n        return typeCache.createModel(options.type, store, options);\n    }\n};\n\nObject.assign(D.Application.prototype, D.Event);\n\nconst PUSH_STATE_SUPPORTED = root.history && ('pushState' in root.history);\nconst ROUTER_REGEXPS = [/:([\\w\\d]+)/g, '([^\\/]+)', /\\*([\\w\\d]+)/g, '(.*)'];\n\nclass Route {\n    constructor (app, router, path, fn) {\n        const pattern = path\n            .replace(ROUTER_REGEXPS[0], ROUTER_REGEXPS[1])\n            .replace(ROUTER_REGEXPS[2], ROUTER_REGEXPS[3]);\n\n        this.pattern = new RegExp(`^${pattern}$`, app.options.caseSensitiveHash ? 'g' : 'gi');\n\n        this.app = app;\n        this.router = router;\n        this.path = path;\n        this.fn = fn;\n    }\n\n    match (hash) {\n        this.pattern.lastIndex = 0;\n        return this.pattern.test(hash);\n    }\n\n    handle (hash) {\n        this.pattern.lastIndex = 0;\n        const args = this.pattern.exec(hash).slice(1),\n            handlers = this.router._getInterceptors(this.path);\n\n        handlers.push(this.fn);\n        return this.router.chain(...map(handlers, (fn, i) => {\n            return (prev) => fn.apply(this.router, (i > 0 ? [prev].concat(args) : args));\n        }));\n    }\n}\n\nD.Router = class Router extends D.Base {\n    constructor (app) {\n        super('Router', {}, {\n            app,\n            _routes: [],\n            _routeMap: {},\n            _interceptors: {}\n        });\n    }\n\n    _initialize () {\n\n    }\n\n    _getHash () {\n        return root.location.hash.slice(1);\n    }\n\n};\n\n"],"sourceRoot":"/source/"}